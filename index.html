<html>
<head>
<title>hexdate</title>
<meta charset="utf-8" name="viewport" content="width=device-width, initial-scale=1.0" />
</head>
<body onload="init();">

<h1>Hexdate</h1>

<div>Today is <span id="hexdate"></span></div>
<div>The current time is <span id="hextime"></span></div>

<h2>Huh?</h2>

<p>
Hexdate is a time system based on subdividing the seconds since the Unix epoch
by digits when formatted in base 16. This leads to time divisions that are
roughly analogous to commonly used ones in the 365/24/60 system based on Earth's
rotation and revolution periods:
</p>

<ul>
<li>second: this is equivalent to the SI base unit second</li>
<li>minex: 256 seconds, roughly four and a quarter minutes</li>
<li>hexur: 16 minex, approximately an hour and eight minutes</li>
<li>dex: 256 minex, about 18.2 hours or 2/3 of a day</li>
<li>wex: 8 dex</li>
<li>mex: 2 wex or 16 dex, a little over 12 days</li>
<li>yex: 16 mex, 194.2 days, or a little over half a year</li>
</ul>

<h2>Try it!</h2>

<p>
The date and time displayed below was initialized to the current time when this
page was loaded. Edit the value of either the Earth date or hexdate, and it will
be converted to display in the other format.
</p>

<div>
<input oninput="convert(this);" type="datetime-local" step="1" id="time" />
<input oninput="convert(this);" type="number" id="utchour" min="-12" max="14" />
<input oninput="convert(this);" type="number" id="utcminute" step="15" min="0" max="45" />
</div>

<div>
<input oninput="convert(this);" id="inyex" size="4" />
<select oninput="convert(this);" id="inmex"></select>
<select oninput="convert(this);" id="index"></select>
<input oninput="convert(this);" id="inmin" size="2"/>
<input oninput="convert(this);" id="insec" size="2"/>
</div>

<button onclick="nowify();">Reset to now</button>

<h2>Why?</h2>

<p>
Mostly for fun, though there are a few advantages:
</p>

<ul>
<li>Compact: a two-digit mex/dex communicates about as much information as a
four-digit month/day, as does a two-digit hexur/minex compared to a four-digit
hour/minute.</li>
<li>Simple: All mex have the same number of dex, and an integer number of wex.
There are no time zones, daylight savings time, leap days, or leap seconds.</li>
<li>Astronomically agnostic: The system is equally as (in)convenient on Earth as
it is outside of Earth.</li>
</ul>

<script>
let dexes = [
    "None",
    "Ones",
    "Deuce",
    "Thirds",
    "Qua",
    "Fi'",
    "Hex",
    "Septer" 
];

let mexes = [
    "Zune",
    "Unuary",
    "Deucember",
    "Tercember",
    "Quadember",
    "Pentember",
    "Hexember",
    "Setember",
    "Octember",
    "Nuvember",
    "Agust",
    "Bay",
    "Chuly",
    "Mard",
    "Ebril",
    "Fenuary"
];

function dexname(dex) {
    return dexes[dex % 8] + (dex < 8 ? "day" : "dee");
}

function componentize(ts) {
    let sse = Math.floor(ts / 1000);
    let modyex = sse % 16777216 + 16777216;

    return {
        'second' : modyex % 256,
        'minex'  : Math.floor(modyex/256) % 256,
        'dex'    : Math.floor(modyex/65536) % 16,
        'mex'    : Math.floor(modyex/1048576) % 16,
        'yex'    : Math.floor(sse/16777216)
    };
}

function getoff() {
    let offhour = document.getElementById('utchour').value;
    let offminute = document.getElementById('utcminute').value;
    let offsign = offhour == 0 ? 1 : offhour / Math.abs(offhour);
    return off = offhour * 3600000 + offsign * 60000 * offminute;
}

function setdate(ts, setoff = false) {
    let d = new Date(ts);
    let off = setoff ? d.getTimezoneOffset() * -60000 : getoff();
    let ld = new Date(d.getTime() + off);

    document.getElementById('time').value = ld.toISOString().split('.')[0];
    document.getElementById('utchour').value = off / 3600000;
    document.getElementById('utcminute').value = ((off/1000) + 60) % 60;
}

function sethexdate(ts) {
    let x = componentize(ts);

    document.getElementById('inyex').value = prex(x.yex);
    document.getElementById('inmex').value = x.mex;
    document.getElementById('index').value = x.dex;
    document.getElementById('inmin').value = prex(x.minex);
    document.getElementById('insec').value = prex(x.second);
}

function getdate() {
    let d = new Date(document.getElementById('time').value + 'Z');

    return d.getTime() - getoff();
}

function gethexdate() {
    let yex = parseInt(document.getElementById('inyex').value, 16);
    let mex = document.getElementById('inmex').value;
    let dex = document.getElementById('index').value;
    let min = parseInt(document.getElementById('inmin').value, 16);
    let hex = parseInt(document.getElementById('insec').value, 16);

    return ((yex * 65536 + mex * 4096 + dex * 256 + min) * 256 + hex) * 1000;
}

function convert(elem) {
    switch (elem.id) {
        case 'time': case 'utchour': case 'utcminute':
        sethexdate(getdate());
        break;
        case 'inyex': case 'inmex': case 'index': case 'inmin': case 'insec':
        setdate(gethexdate());
        break;
        default: break;
    }
}

function nowify() {
    let ts = new Date().getTime();

    setdate(ts, true);
    sethexdate(ts);
}

function init() {
    for (let i = 0; i < 16; i++) {
        let mex = document.createElement("option");
        let dex = document.createElement("option");

        mex.innerHTML = `${i.toString(16)} - ${mexes[i]}`;
        mex.value = i;

        document.getElementById('inmex').append(mex);

        dex.innerHTML = `${i.toString(16)} - ${dexname(i)}`;
        dex.value = i;

        document.getElementById('index').append(dex);
    }

    nowify();
    update();
    window.setInterval(update, 1000);
}

function prex(num) {
    return num.toString(16).padStart(2, '0').toUpperCase()
}

function update() {
    let now = componentize(Date.now());

    document.getElementById("hexdate").innerText = `${dexname(now.dex)}, ${mexes[now.mex]} ${now.dex}, yex ${prex(now.yex)}`; 
    document.getElementById("hextime").innerText = `${prex(now.minex)}:${prex(now.second)}`;
}
</script>
</body>
</html>
